<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>CHEMIDREAM TERMINAL</title>

<style>
html, body {
  margin: 0;
  padding: 0;
  width: 100%;
  height: 100%;
  background: black;
  font-family: monospace;
  color: #9cff9c;
  overflow: hidden;
}

/* ===== BOOT SCREEN ===== */
#boot-screen {
  position: fixed;
  inset: 0;
  background: black;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 24px;
  animation: flicker 1.5s infinite;
}

@keyframes flicker {
  0%,100% { opacity: 1; }
  50% { opacity: 0.6; }
}

/* ===== MONITOR BACKGROUND (optional image) ===== */
#background {
  position: fixed;
  inset: 0;
  background: url("assets/monitor.jpg") center center no-repeat;
  background-size: cover;
  z-index: -2;
}

/* ===== SCREEN NOISE ===== */
body::after {
  content: "";
  position: fixed;
  inset: 0;
  background: repeating-linear-gradient(
    to bottom,
    rgba(255,255,255,0.03),
    rgba(255,255,255,0.03) 1px,
    transparent 1px,
    transparent 3px
  );
  pointer-events: none;
  z-index: 10;
}

/* ===== TERMINAL ===== */
.monitor {
  position: fixed;
  inset: 0;
  padding: 40px;
  display: none;
}

#terminal {
  white-space: pre-wrap;
  line-height: 1.4;
}

#input-line {
  display: flex;
}

#prompt {
  margin-right: 8px;
}

#input {
  outline: none;
  border: none;
  background: transparent;
  color: #9cff9c;
  flex: 1;
}

/* Cursor blink */
.cursor {
  display: inline-block;
  width: 10px;
  background: #9cff9c;
  margin-left: 2px;
  animation: blink 1s steps(2) infinite;
}

@keyframes blink {
  0% { opacity: 1; }
  50% { opacity: 0; }
}
</style>
</head>

<body>

<div id="background"></div>

<div id="boot-screen">
  PRESS ANY KEY TO CONTINUE
</div>

<div class="monitor">
  <div id="terminal"></div>
  <div id="input-line">
    <span id="prompt">&gt;</span>
    <span id="input"></span><span class="cursor"></span>
  </div>
</div>

<script>
const terminal = document.getElementById("terminal");
const input = document.getElementById("input");
const boot = document.getElementById("boot-screen");
const monitor = document.querySelector(".monitor");

let idleTimer;
let idleMessages = [
  "PROCESS 66: pain response still active.",
  "ERROR // memory bleed detected.",
  "You are not supposed to be here.",
  "Observer presence confirmed.",
  "This system remembers you.",
  "Body reference: NULL.",
  "Why are you watching?",
  "Subject still believes this is real."
];

function type(text, delay = 20) {
  return new Promise(resolve => {
    let i = 0;
    let interval = setInterval(() => {
      terminal.innerHTML += text[i];
      i++;
      if (i >= text.length) {
        clearInterval(interval);
        terminal.innerHTML += "\n";
        resolve();
      }
    }, delay);
  });
}

async function bootSequence() {
  const lines = [
    "CHEMIDREAM INTERNAL INTERFACE",
    "ACCESS NODE: UNKNOWN",
    "",
    "> initializing display...",
    "> synchronizing consciousness core...",
    "> ERROR // unauthorized observer detected",
    "",
    "SYSTEM ONLINE.",
    "",
    "TYPE 'HELP'"
  ];

  for (let line of lines) {
    await type(line);
  }
}

function resetIdleTimer() {
  clearTimeout(idleTimer);
  idleTimer = setTimeout(() => {
    const msg = idleMessages[Math.floor(Math.random() * idleMessages.length)];
    terminal.innerHTML += "\n" + msg + "\n";
    scrollDown();
    resetIdleTimer();
  }, 15000); // 15 секунд бездействия
}

function scrollDown() {
  window.scrollTo(0, document.body.scrollHeight);
}

document.addEventListener("keydown", async (e) => {
  if (boot.style.display !== "none") {
    boot.style.display = "none";
    monitor.style.display = "block";
    await bootSequence();
    resetIdleTimer();
    return;
  }

  resetIdleTimer();

  if (e.key === "Backspace") {
    input.textContent = input.textContent.slice(0, -1);
  } else if (e.key === "Enter") {
    const command = input.textContent.trim().toLowerCase();
    terminal.innerHTML += `\n> ${command}\n`;
    handleCommand(command);
    input.textContent = "";
  } else if (e.key.length === 1) {
    input.textContent += e.key;
  }
});

function handleCommand(cmd) {
  switch (cmd) {
    case "help":
      terminal.innerHTML +=
        "AVAILABLE COMMANDS:\n" +
        "- help\n" +
        "- status\n" +
        "- observe\n" +
        "- exit\n";
      break;

    case "status":
      terminal.innerHTML +=
        "SUBJECT: VENIAMIN\n" +
        "BODY: NOT FOUND\n" +
        "STATE: AWAKE\n";
      break;

    case "observe":
      terminal.innerHTML +=
        "OBSERVATION NOT RECOMMENDED.\n" +
        "PAIN RESPONSE INCREASING.\n";
      break;

    case "exit":
      terminal.innerHTML += "EXIT DENIED.\n";
      break;

    default:
      terminal.innerHTML += "UNKNOWN COMMAND.\n";
  }

  scrollDown();
}
</script>

</body>
</html>
